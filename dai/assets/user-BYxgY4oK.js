import{I as f,J as g,K as $,r as s,G as F}from"./index-DXYhwSMD.js";function v(t,r,e=null){var a;t.response?(r(`Error ${t.response.status}: ${((a=t.response.data)==null?void 0:a.message)||"Error del servidor"}`,"danger","Error"),e&&t.response.data.errors&&e(t.response.data.errors)):t.request?r("No se recibió respuesta del servidor","danger","Error"):r("Error al realizar la solicitud","danger","Error")}async function T(t){var e;const r=f();try{const a=await g.get(t);if(a.status===200)return a.data.datos??[];{const l=new Error(((e=a.data)==null?void 0:e.message)||"Error inesperado");throw l.response=a,l}}catch(a){throw v(a,r.setAlert),a}}async function C(t,r){var a;const e=f();try{const l=await g.get(`${t}/${r}`);if(l.status===200)return l.data.datos??null;{const n=new Error(((a=l.data)==null?void 0:a.message)||"Error inesperado");throw n.response=l,n}}catch(l){throw v(l,e.setAlert),l}}function R(t){const r=new FormData;for(const e in t)t[e]instanceof File?r.append(e,t[e]):Array.isArray(t[e])?t[e].forEach((a,l)=>{r.append(`${e}[${l}]`,a)}):r.append(e,t[e]);return r}const U={async update(t,r,e=!0){const a=e?R(r):r;return await g.post(t,a)}},z=$("user",()=>{const t=f(),r=s([{title:"ID",align:"left",key:"id"},{title:"NOMBRE",align:"left",key:"name"},{title:"APELLIDO",align:"end",key:"last_name"},{title:"FECHA DE NACIMIENTO",align:"end",key:"date_of_birth_format"},{title:"DPI",align:"end",key:"dpi"},{title:"NIT",align:"end",key:"nit"},{title:"FOTO",align:"middle",key:"profile_picture_url"},{title:"ESTADO",align:"middle",key:"state"},{title:"ACCIONES",align:"end",key:"actions",sort:!0}]);let e=s([]),a=s([]),l=s(null),n=s([]),i=s(!1),d=s([]),h=s(!1),y=s(!1),p=s(!1),E=s(!1),m=s(!1),_=s(!1),b=s(!1),S=s(!1),k=F({user_id:"",date_of_birth:"",phone_number:"",address:"",nit:"",dpi:"",gender:"",city:"",country:"",profile_picture_url:""});const N=o=>{o.value=o};function D(o,u=null){switch(n.value=u,o){case 1:E.value=!0;break;case 2:p.value=!0;break}y.value=!0}async function I(){i.value=!0,e.value="",d.value=[];try{d.value=await T("personal_details"),console.log(d.value)}catch{e.value="No se pudieron cargar los registros."}finally{i.value=!1}}async function O(){i.value=!0,e.value="",n.value=[];let o=JSON.parse(localStorage.getItem("user"));try{n.value=await C("personal_details",o==null?void 0:o.id)}catch{e.value="No se pudieron cargar los registros."}finally{i.value=!1}}async function A(){var u;p.value=!0,e.value="",a.value=[];const o=JSON.parse(localStorage.getItem("user"));try{const c="personal_details/"+o.id,w={...n.value};w.user_id=o.id;const x=await U.update(c,w,!1);t.setAlert(((u=x.data)==null?void 0:u.message)||"Detalles personales actualizados exitosamente.","success","Éxito")}catch(c){a.value=c.response.data.errors,console.log(c.response.data.errors),v(c,t.setAlert)}finally{p.value=!1}}return{errors:e,setErrors:N,validationErrors:a,headers:r,records:d,loadingRecords:h,record:n,loadingRecord:i,loadingOptions:y,id:l,optionUpdate:p,optionNew:E,optionDelete:m,buttonUpdate:_,buttonNew:b,buttonDelete:S,newRecord:k,options:D,index:I,show:O,update:A}});export{z as u};
