import{_ as j,r as b,H as c,B as I,D as N,c as a,h as r,b as e,e as l,a as q,l as v,m as g,g as A,d as f,v as x,t as B,j as D,i as H,o as n}from"./index-CwaQPSV_.js";import{u as M,N as R}from"./newRequest-ndkV2YNW.js";import{u as U}from"./supply-yXzu10N6.js";import{H as $}from"./Header-Cl2YdGa1.js";import{T as P}from"./Top-B3CFE1E3.js";import{P as T}from"./Process-Be5-tuJY.js";import"./functions-BSmh5TsC.js";const z={class:"min-h-screen bg-slate-50 p-6"},E={key:0,class:"space-y-6"},F={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6"},G={class:"animate-pulse"},Q={class:"space-y-3"},Y={key:1,class:"max-w-4xl mx-auto"},J={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6"},K={class:"flex items-center justify-between mb-4"},O=["disabled"],W={class:"space-y-3"},X={class:"flex-1"},Z={class:"w-32"},ee=["onUpdate:modelValue","max"],se=["onClick"],te={class:"flex-1 items-center gap-4 p-4 bg-slate-50 rounded-lg border border-slate-200"},oe={class:"text-right text-xs text-slate-500 mt-1"},de={key:0,class:"text-center py-8 text-slate-500"},ae={class:"flex justify-end gap-3 mt-6 pt-4 border-t border-slate-200"},le=["disabled"],ne={__name:"AdjustView",setup(re){const t=M(),p=U(),y=N(),h=D();b(!1),b(!1),c(()=>{const s=new Date(t.records.created_at).getFullYear();return t.records.id+"-"+s});const w=c(()=>p.records.filter(o=>o.state==="1").map(o=>({...o,name:`${o.name} ( ${o.stock} )`})));let _=1;function k(o){const s=this.supplies.find(u=>u.id===o);return s?s.stock:99999}const S=c(()=>t.supplyLines.length>0&&t.supplyLines.every(o=>o.supplyId&&o.quantity>0)),m=()=>{t.supplyLines.length<10&&t.supplyLines.push({id:_++,supplyId:"",quantity:1})},V=o=>{t.supplyLines.splice(o,1)};m(),I(()=>{t.id=y.params.id,t.show(),p.index()});async function L(){await t.processing()===!0&&h.push({name:"manager"})}return(o,s)=>{const u=H("Select");return n(),a("div",null,[r($),e("div",z,[l(t).loadingRecords?(n(),a("div",E,[s[6]||(s[6]=q('<div class="bg-white rounded-lg shadow-sm border border-slate-200 p-6" data-v-556d2fc6><div class="animate-pulse" data-v-556d2fc6><div class="h-6 bg-slate-200 rounded w-1/3 mb-4" data-v-556d2fc6></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4" data-v-556d2fc6><div class="h-4 bg-slate-200 rounded" data-v-556d2fc6></div><div class="h-4 bg-slate-200 rounded" data-v-556d2fc6></div><div class="h-4 bg-slate-200 rounded" data-v-556d2fc6></div><div class="h-4 bg-slate-200 rounded" data-v-556d2fc6></div></div><div class="h-20 bg-slate-200 rounded" data-v-556d2fc6></div></div></div>',1)),e("div",F,[e("div",G,[s[4]||(s[4]=e("div",{class:"h-6 bg-slate-200 rounded w-1/4 mb-4"},null,-1)),e("div",Q,[(n(),a(v,null,g(3,d=>e("div",{key:d,class:"flex gap-4"},s[3]||(s[3]=[e("div",{class:"h-10 bg-slate-200 rounded flex-1"},null,-1),e("div",{class:"h-10 bg-slate-200 rounded w-24"},null,-1),e("div",{class:"h-10 bg-slate-200 rounded w-10"},null,-1)]))),64))]),s[5]||(s[5]=e("div",{class:"flex gap-3 mt-6"},[e("div",{class:"h-10 bg-slate-200 rounded w-24"}),e("div",{class:"h-10 bg-slate-200 rounded w-24"})],-1))])])])):(n(),a("div",Y,[e("div",J,[e("div",K,[s[7]||(s[7]=e("h2",{class:"text-lg font-semibold text-slate-900"},"Suministros a Ajustar",-1)),e("button",{onClick:m,disabled:l(t).supplyLines.length>=10,class:"px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors duration-200 text-sm font-medium"}," Agregar ",8,O)]),e("div",W,[(n(!0),a(v,null,g(l(t).supplyLines,(d,C)=>(n(),a("div",{key:d.id,class:"flex items-center gap-4 p-4 bg-slate-50 rounded-lg border border-slate-200"},[e("div",X,[s[8]||(s[8]=e("label",{class:"block text-xs font-medium text-slate-600 mb-1"},"Suministro",-1)),r(u,{modelValue:d.supplyId,"onUpdate:modelValue":i=>d.supplyId=i,options:w.value,placeholder:"Seleccionar suministro...",class:"w-full px-3 py-2"},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Z,[s[9]||(s[9]=e("label",{class:"block text-xs font-medium text-slate-600 mb-1"},"Cantidad",-1)),f(e("input",{"onUpdate:modelValue":i=>d.quantity=i,type:"number",min:"1",max:k(d.supplyId),class:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"0"},null,8,ee),[[x,d.quantity,void 0,{number:!0}]])]),e("button",{onClick:i=>V(C),class:"mt-5 p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200",title:"Eliminar línea"},s[10]||(s[10]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,se)]))),128)),e("div",te,[s[11]||(s[11]=e("label",{class:"block text-xs font-medium text-slate-600 mb-1"},"Descripción",-1)),f(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=d=>l(t).description=d),maxlength:"255",class:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"},"                            ",512),[[x,l(t).description]]),e("p",oe,B(l(t).description.length)+" / 255 ",1)]),l(t).supplyLines.length===0?(n(),a("div",de,' No hay líneas de suministros. Haz clic en "Agregar" para comenzar. ')):A("",!0)]),e("div",ae,[e("button",{onClick:s[1]||(s[1]=()=>{}),class:"px-6 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors duration-200 font-medium"}," Cancelar "),e("button",{onClick:s[2]||(s[2]=d=>L()),disabled:!S.value,class:"px-6 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors duration-200 font-medium"}," Guardar Procesamiento ",8,le)])])]))]),r(P),r(R),r(T)])}}},ge=j(ne,[["__scopeId","data-v-556d2fc6"]]);export{ge as default};
