import{u as A,N}from"./newRequest-DpIAfi6X.js";import{H as O}from"./Header-e3ekgFPA.js";import{T as H}from"./Top-ZxopemuS.js";import{k as E,_ as D,y as F,r as k,H as U,c as d,h as l,z as u,b as e,g as f,q as $,x as _,t as m,e as s,s as q,T as B,d as j,v as T,l as w,m as y,i as z,X as G,A as I,o as n,B as M,a as P,n as C,p as V}from"./index-CT9M8n2Q.js";import{u as Q}from"./supply-NUZ_OKsG.js";import{C as X}from"./chevron-down-DkUbBth4.js";import{V as J,L as K}from"./View-D9nUgL_a.js";import{B as W,p as Y}from"./pdfService-DHNsYMud.js";import{L as Z}from"./list-restart-B9xGBL_R.js";import{E as ee}from"./eye-D0wlx8Xg.js";import"./functions-DBwAmeLf.js";/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=E("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=E("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),oe={class:"grid gap-4"},ae={class:"text-base text-gray-600"},ie={class:"font-bold text-primary"},ne={key:0,class:"bg-white rounded-2xl shadow p-6 space-y-4"},re={class:"flex items-center"},le={class:"text-gray-800 font-medium"},de={class:"flex items-center"},ce={class:"text-gray-800 font-medium"},ue={class:"flex items-center"},be={class:"text-gray-800 font-medium"},pe={class:"flex justify-center items-center"},ve={key:0,class:"bg-white rounded-2xl shadow p-4 space-y-2"},me={class:"divide-y divide-gray-200"},fe={class:"text-gray-700"},ge={class:"text-gray-900 font-semibold"},he={key:0,class:"text-gray-500 italic"},xe={key:2,class:"text-xs text-red-500"},we={class:"flex justify-between w-full space-x-4"},ye=["disabled"],_e=["disabled"],ke={__name:"Authorization",setup(R){const a=A(),h=Q(),r=F({title:"Gestionar solicitud",subtitle:"",size:"md",showHeader:!0,showFooter:!0,showCloseButton:!0,showCancelButton:!1,showConfirmButton:!1,cancelButtonText:"Cancelar",confirmButtonText:"Guardar",confirmButtonClass:"bg-green-600 hover:bg-blue-700 focus:ring-green-500",loadingText:"Procesando...",closeOnOverlay:!1,closeOnEscape:!1,loading:!1,bodyClasses:"p-8",footerClasses:"bg-gray-50"}),p=k(!1),i=k(!1),v=k(!1),x=k(""),o=U(()=>x.value?h.records.filter(g=>g.state==1&&g.stock>=1&&g.name.toLowerCase().includes(x.value.toLowerCase())):h.records.filter(g=>g.state==1&&g.stock>=1));async function b(){p.value||await h.index(),p.value=!p.value}function L(){i.value?a.reason_reject.length>=10?(a.reject(),v.value=!1):v.value=!0:i.value=!0}return(g,t)=>{const S=z("Errors");return n(),d("div",null,[l(I,{modelValue:s(a).optionAuthorization,"onUpdate:modelValue":t[4]||(t[4]=c=>s(a).optionAuthorization=c),title:r.title,subtitle:r.subtitle,size:r.size,"show-header":r.showHeader,"show-footer":r.showFooter,"show-close-button":r.showCloseButton,"show-cancel-button":r.showCancelButton,"show-confirm-button":r.showConfirmButton,"cancel-button-text":r.cancelButtonText,"confirm-button-text":r.confirmButtonText,"confirm-button-class":r.confirmButtonClass,"loading-text":r.loadingText,"close-on-overlay":r.closeOnOverlay,"close-on-escape":r.closeOnEscape,loading:r.loading,"body-classes":r.bodyClasses,"footer-classes":r.footerClasses},{footer:u(()=>t[14]||(t[14]=[])),default:u(()=>[e("div",oe,[e("p",ae,[t[5]||(t[5]=_(" Gestione la solicitud de suministros de ")),e("span",ie,m(s(a).record.user),1),t[6]||(t[6]=_(". "))]),s(a).loadingOptions?(n(),d("div",ne,[e("div",re,[t[7]||(t[7]=e("label",{class:"text-teal-800 font-semibold w-1/3"},"Descripción",-1)),e("div",le,m(s(a).record.description),1)]),e("div",de,[t[8]||(t[8]=e("label",{class:"text-teal-800 font-semibold w-1/3"},"Fecha",-1)),e("div",ce,m(s(a).record.fecha_creacion_format),1)]),e("div",ue,[t[9]||(t[9]=e("label",{class:"text-teal-800 font-semibold w-1/3"},"Estado",-1)),e("div",be,m(s(a).record.state),1)])])):f("",!0),e("div",pe,[e("button",{onClick:b,class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl font-semibold shadow text-xs"},[t[10]||(t[10]=_(" Ver disponibilidad ")),(n(),$(q(p.value?s(se):s(X)),{class:"w-3 h-3"}))])]),l(B,{name:"fade"},{default:u(()=>[p.value?(n(),d("div",ve,[t[11]||(t[11]=e("h3",{class:"text-teal-800 font-semibold"},"Disponibilidad de suministros",-1)),j(e("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>x.value=c),type:"text",placeholder:"Buscar suministro...",class:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"},null,512),[[T,x.value]]),e("ul",me,[(n(!0),d(w,null,y(o.value,c=>(n(),d("li",{key:c.id,class:"py-2 flex justify-between text-xs"},[e("span",fe,m(c.name),1),e("span",ge,m(c.stock),1)]))),128))]),o.value.length===0?(n(),d("p",he," No hay disponibilidad registrada. ")):f("",!0)])):f("",!0)]),_:1}),i.value?(n(),$(B,{key:1,name:"fade"},{default:u(()=>[j(e("textarea",{placeholder:"motivo de rechazo","onUpdate:modelValue":t[1]||(t[1]=c=>s(a).reason_reject=c),class:"w-full px-3 pt-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[T,s(a).reason_reject]])]),_:1})):f("",!0),v.value?(n(),d("span",xe," La razón del rechazo debe tener al menos 10 caracteres. ")):f("",!0),l(S,{errors:s(a).validationErrors},null,8,["errors"]),e("div",we,[e("button",{onClick:t[2]||(t[2]=c=>L()),class:"bg-red-600 hover:bg-red-700 p-2 rounded-xl text-white flex items-center justify-center font-semibold disabled:opacity-100 disabled:cursor-not-allowed disabled:bg-slate-400",disabled:s(a).buttonAuthorization},[t[12]||(t[12]=_(" Rechazar ")),l(s(G),{class:"ml-2 w-5 h-5"})],8,ye),e("button",{onClick:t[3]||(t[3]=c=>s(a).approbe()),type:"button",class:"bg-green-600 hover:bg-green-700 p-2 rounded-xl text-white flex items-center justify-center font-semibold disabled:opacity-100 disabled:cursor-not-allowed disabled:bg-slate-400",disabled:s(a).buttonAuthorization},[t[13]||(t[13]=_(" Autorizar ")),l(s(te),{class:"ml-2 w-5 h-5"})],8,_e)])])]),_:1},8,["modelValue","title","subtitle","size","show-header","show-footer","show-close-button","show-cancel-button","show-confirm-button","cancel-button-text","confirm-button-text","confirm-button-class","loading-text","close-on-overlay","close-on-escape","loading","body-classes","footer-classes"])])}}},Ce=D(ke,[["__scopeId","data-v-0d6b13d5"]]),$e={key:0,class:"min-h-screen bg-gray-50 p-6"},ze={class:"max-w-7xl mx-auto"},Be={class:"flex justify-center gap-3 mb-1"},je={class:"mb-8"},Te={class:"flex items-center justify-center gap-2"},Ve=["onClick"],Ae=["onClick"],Ee=["onClick"],De={key:0,class:"fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg"},Re={key:1,class:"w-full space-y-4 p-6"},Le={class:"bg-white rounded-lg shadow-sm border overflow-hidden"},Se={class:"bg-gray-50 border-b"},Ne={class:"grid grid-cols-12 gap-4 p-4"},Oe={class:"divide-y divide-gray-200"},He={class:"flex items-center justify-between pt-4"},Fe={class:"flex items-center space-x-2"},Ue={class:"flex justify-center space-x-2 pt-4"},qe={__name:"AuthorizationView",setup(R){const a=A(),h=k("");function r(p){Y.downloadSolicitud(p)}return M(()=>{a.show_to_chiefs()}),(p,i)=>{const v=z("Tooltip"),x=z("DataTable");return n(),d("div",null,[l(O),s(a).loadingRecords?(n(),d("div",Re,[i[6]||(i[6]=P('<div class="flex items-center justify-between mb-6" data-v-1b37c9ca><div class="space-y-2" data-v-1b37c9ca><div class="h-8 bg-gray-200 rounded-md w-48 animate-pulse relative overflow-hidden" data-v-1b37c9ca><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer" data-v-1b37c9ca></div></div><div class="h-4 bg-gray-200 rounded-md w-32 animate-pulse relative overflow-hidden" data-v-1b37c9ca><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer" data-v-1b37c9ca></div></div></div><div class="flex items-center space-x-3" data-v-1b37c9ca><div class="h-10 bg-gray-200 rounded-md w-64 animate-pulse relative overflow-hidden" data-v-1b37c9ca><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer" data-v-1b37c9ca></div></div><div class="h-10 bg-gray-200 rounded-md w-24 animate-pulse relative overflow-hidden" data-v-1b37c9ca><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer" data-v-1b37c9ca></div></div></div></div>',1)),e("div",Le,[e("div",Se,[e("div",Ne,[(n(),d(w,null,y(4,o=>e("div",{key:o.id,class:C(o.class)},i[2]||(i[2]=[e("div",{class:"h-4 bg-gray-300 rounded animate-pulse relative overflow-hidden"},[e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer"})],-1)]),2)),64))])]),e("div",Oe,[(n(),d(w,null,y(2,o=>e("div",{key:o,class:"grid grid-cols-12 gap-4 p-4 hover:bg-gray-50"},[(n(),d(w,null,y(4,b=>e("div",{key:`${o}-${b.id}`,class:C(b.class)},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse relative overflow-hidden",style:V({width:b.id===2?"80%":b.id===3?"90%":"70%"})},i[3]||(i[3]=[e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer"},null,-1)]),4)],2)),64))])),64))])]),e("div",He,[i[5]||(i[5]=e("div",{class:"h-4 bg-gray-200 rounded w-32 animate-pulse relative overflow-hidden"},[e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer"})],-1)),e("div",Fe,[(n(),d(w,null,y(5,o=>e("div",{key:o,class:"h-8 w-8 bg-gray-200 rounded animate-pulse relative overflow-hidden"},i[4]||(i[4]=[e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shimmer"},null,-1)]))),64))])]),i[7]||(i[7]=e("div",{class:"flex items-center justify-center py-8"},[e("div",{class:"flex items-center space-x-3"},[e("div",{class:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",{class:"text-gray-600 animate-pulse"},"Cargando datos...")])],-1)),e("div",Ue,[(n(),d(w,null,y(3,o=>e("div",{key:o,class:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:V({animationDelay:`${(o-1)*.2}s`,animationDuration:"1s"})},null,4)),64))])])):(n(),d("div",$e,[i[1]||(i[1]=e("div",{class:"font-extrabold text-4xl text-center mb-10"},"Solicitudes por revisar",-1)),e("div",ze,[e("div",Be,[l(v,{message:"Recargar datos",position:"top"},{default:u(()=>[e("button",{onClick:i[0]||(i[0]=o=>s(a).show_to_chiefs()),class:"rounded-full bg-yellow-500 boder-2 border-yellow-600 h-10 w-10 flex justify-center items-center text-white font-bold"},[l(s(Z),{class:"w-4 h-4"})])]),_:1})]),e("div",je,[l(x,{data:s(a).records,headers:s(a).headers},{state:u(({item:o})=>[e("span",{class:C([[o.status==="pending"?"bg-sky-500":o.status==="authorized"?"bg-green-500":o.status==="processed"?"bg-teal-500":"bg-red-500"],"px-2 rounded-xl text-white font-bold"])},m(o.state),3)]),actions:u(({item:o})=>[e("div",Te,[l(v,{message:"Ver solicitud",position:"top"},{default:u(()=>[e("button",{onClick:b=>s(a).options(6,o),class:"text-orange-700 hover:text-orange-900 p-1 font-bold",title:"Eliminar"},[l(s(ee),{class:"w-4 h-4"})],8,Ve)]),_:2},1024),o.path_file?(n(),$(v,{key:0,message:"Ver documento",position:"top"},{default:u(()=>[e("button",{onClick:b=>r(o.id),class:"text-blue-700 hover:text-blue-900 p-1 font-bold",title:"Eliminar"},[l(s(W),{class:"w-4 h-4"})],8,Ae)]),_:2},1024)):f("",!0),l(v,{message:"Autorizar/Rechazar",position:"top"},{default:u(()=>[o.status==="pending"?(n(),d("button",{key:0,onClick:b=>s(a).options(4,o),class:"text-teal-700 hover:text-teal-900 p-1 font-bold",title:"Eliminar"},[l(s(K),{class:"w-4 h-4"})],8,Ee)):f("",!0)]),_:2},1024)])]),_:1},8,["data","headers"])]),h.value?(n(),d("div",De,m(h.value),1)):f("",!0)])])),l(H),l(N),l(Ce),l(J)])}}},et=D(qe,[["__scopeId","data-v-1b37c9ca"]]);export{et as default};
