import{K as ee,I as te,r as s,y as U,_ as se,c as ae,h as T,z as V,b as v,d as oe,v as le,e as g,i as j,o as re}from"./index-CwaQPSV_.js";import{u as ne,h as p,a as k,s as M,l as q,b as J,d as ue}from"./functions-BSmh5TsC.js";const ie=ee("request",()=>{const o=te(),c=s([{title:"ID",align:"left",key:"id"},{title:"DESCRIPCIÓN",align:"left",key:"description"},{title:"ESTADO",align:"middle",key:"state"},{title:"ACCIONES",align:"center",key:"actions",sort:!0}]);let e=s([]),d=s([]),m=s(null),r=s([]),y=s(!1),n=s([]),u=s(!1),O=s(!1),G=s(!1),_=s(!1),x=s(!1),w=s(!1),I=s(!1),R=s(!1),H=s(!1),P=s(!1),b=s(!1),C=s(!1),N=s(!1),S=s(!1),h=U({description:"",user_id:""}),A=s([]),z=s(""),E=s("");function F(t,a=null){switch(r.value=a,t){case 1:_.value=!0;break;case 3:x.value=!0;break;case 4:w.value=!0;break;case 5:I.value=!0;break;case 6:R.value=!0;break}O.value=!0}async function $(){u.value=!0,e.value="",n.value=[];try{n.value=await ne("request_supplies_manager"),n.value==null&&o.setAlert("Error al cargar los datos.","danger","Error")}catch(t){e.value="No se pudieron cargar los registros.",p(t,o.setAlert)}finally{u.value=!1}}async function K(){u.value=!0,e.value="",n.value=[];try{n.value=await k("request_supplies",m.value)}catch(t){e.value="No se pudieron cargar los registros.",p(t,o.setAlert)}finally{u.value=!1}}async function L(){u.value=!0,e.value="",n.value=[];let t=JSON.parse(localStorage.getItem("user"));try{n.value=await k("request_supplies_user",t==null?void 0:t.id),n.value==null&&o.setAlert("Error al mostrar los datos.","success","Éxito")}catch(a){e.value="No se pudieron cargar los registros.",p(a,o.setAlert)}finally{u.value=!1}}async function D(){var a;u.value=!0,e.value="",n.value=[];let t=JSON.parse(localStorage.getItem("user"));try{n.value=await k("request_supplies/supervisor",t==null?void 0:t.id),n.value==null&&o.setAlert(((a=response.data)==null?void 0:a.message)||"Detalles personales creados exitosamente.","success","Éxito")}catch(l){e.value="No se pudieron cargar los registros.",p(l,o.setAlert)}finally{u.value=!1}}async function Q(){var t,a;N.value=!0,e.value="",d.value=[];try{let l=JSON.parse(localStorage.getItem("user"));const i="request_supplies";h.user_id=l==null?void 0:l.id;const f={...h},B=await M.store(i,f,!1);o.setAlert(((t=B.data)==null?void 0:t.message)||"Solicitud creada exitosamente.","success","Éxito"),_.value=!1,this.show_by_user(),q(h)}catch(l){d.value=(a=l.response)==null?void 0:a.data.errors,p(l,o.setAlert)}finally{N.value=!1}}async function W(){var t;b.value=!0,e.value="",d.value=[];try{const a="request_supplies/approbe/"+r.value.id,l=await J.update(a);o.setAlert(((t=l.data)==null?void 0:t.message)||"Detalles personales actualizados exitosamente.","success","Éxito"),w.value=!1,this.show_to_chiefs()}catch(a){p(a,o.setAlert)}finally{b.value=!1}}async function X(t=null){var i;b.value=!0,e.value="",d.value=[];let a="";const l={reason_reject:E.value};try{t?a="request_supplies/reject/"+n.value.id:a="request_supplies/reject/"+r.value.id;const f=await J.update(a,l);return o.setAlert(((i=f.data)==null?void 0:i.message)||"Solicitud de suministros rechazada exitosamente.","success","Éxito"),E.value="",t?!0:(w.value=!1,D(),!1)}catch(f){d.value=f.response.data.errors||"Error",p(f,o.setAlert)}finally{b.value=!1}}async function Y(){var t,a,l;S.value=!0,e.value="",d.value=[];try{const i="request_supplies/"+r.value.id,f=await ue.destroy(i);console.log(i),o.setAlert(((t=f.data)==null?void 0:t.message)||"Solicitud eliminada exitosamente.","success","Éxito"),x.value=!1,this.show_by_user()}catch(i){d.value=((l=(a=i.response)==null?void 0:a.data)==null?void 0:l.errors)||[],p(i,o.setAlert)}finally{S.value=!1}}async function Z(){var l,i;C.value=!0,e.value="",d.value=[];let t=JSON.parse(localStorage.getItem("user"));const a={suministros:A.value,description:z.value,user_id:t.id,request_id:m.value};try{const B=await M.store("supplies_movement",a,!1);return o.setAlert(((l=B.data)==null?void 0:l.message)||"despacho creado exitosamente.","success","Éxito"),this.show(),q(A),!0}catch(f){return d.value=(i=f.response)==null?void 0:i.data.errors,p(f,o.setAlert),!1}finally{C.value=!1}}return{errors:e,validationErrors:d,headers:c,records:n,loadingRecords:u,record:r,loadingRecord:y,loadingOptions:O,id:m,optionUpdate:G,optionNew:_,optionDelete:x,optionAuthorization:w,optionManager:I,optionView:R,buttonAuthorization:b,buttonManager:P,buttonUpdate:H,buttonNew:N,buttonDelete:S,buttonProcessing:C,newRecord:h,supplyLines:A,description:z,reason_reject:E,options:F,index_to_manager:$,show:K,show_to_chiefs:D,show_by_user:L,store:Q,approbe:W,reject:X,destroy:Y,processing:Z}}),ce={class:"grid gap-2"},de={class:"grid grid-cols-1 gap-4"},fe=["disabled"],pe={__name:"newRequest",setup(o){const c=ie(),e=U({title:"Crear solicitud",subtitle:"",size:"lg",showHeader:!0,showFooter:!0,showCloseButton:!0,showCancelButton:!1,showConfirmButton:!1,cancelButtonText:"Cancelar",confirmButtonText:"Guardar",confirmButtonClass:"bg-green-600 hover:bg-blue-700 focus:ring-green-500",loadingText:"Procesando...",closeOnOverlay:!1,closeOnEscape:!1,loading:!1,bodyClasses:"p-8",footerClasses:"bg-gray-50"});function d(){q(c.newRecord),c.optionNew=!1,c.validationErrors=[]}return(m,r)=>{const y=j("Errors"),n=j("Modal");return re(),ae("div",null,[T(n,{modelValue:g(c).optionNew,"onUpdate:modelValue":r[3]||(r[3]=u=>g(c).optionNew=u),title:e.title,subtitle:e.subtitle,size:e.size,"show-header":e.showHeader,"show-footer":e.showFooter,"show-close-button":e.showCloseButton,"show-cancel-button":e.showCancelButton,"show-confirm-button":e.showConfirmButton,"cancel-button-text":e.cancelButtonText,"confirm-button-text":e.confirmButtonText,"confirm-button-class":e.confirmButtonClass,"loading-text":e.loadingText,"close-on-overlay":e.closeOnOverlay,"close-on-escape":e.closeOnEscape,loading:e.loading,"body-classes":e.bodyClasses,"footer-classes":e.footerClasses},{footer:V(()=>[v("button",{onClick:r[1]||(r[1]=u=>d()),class:"bg-red-600 hover:bg-red-700 focus:ring-red-500 p-2 rounded-xl text-white"},"Cancelar"),v("button",{onClick:r[2]||(r[2]=u=>g(c).store()),type:"button",class:"bg-green-600 hover:bg-green-700 focus:ring-green-500 p-2 rounded-xl text-white disabled:opacity-100 disabled:cursor-not-allowed disabled:bg-slate-400",disabled:g(c).buttonNew},"Guardar",8,fe)]),default:V(()=>[v("div",ce,[v("div",de,[v("div",null,[r[4]||(r[4]=v("label",{for:"firstName",class:"block text-sm font-medium text-gray-700 mb-1"},"Descripción de solicitud",-1)),oe(v("textarea",{id:"firstName","onUpdate:modelValue":r[0]||(r[0]=u=>g(c).newRecord.description=u),type:"text",placeholder:"No. articulo",rows:"6",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[le,g(c).newRecord.description]])])]),v("div",null,[T(y,{errors:g(c).validationErrors},null,8,["errors"])])])]),_:1},8,["modelValue","title","subtitle","size","show-header","show-footer","show-close-button","show-cancel-button","show-confirm-button","cancel-button-text","confirm-button-text","confirm-button-class","loading-text","close-on-overlay","close-on-escape","loading","body-classes","footer-classes"])])}}},be=se(pe,[["__scopeId","data-v-9ef9c824"]]);export{be as N,ie as u};
